# Решения для обеспечения постоянства данных в Kubernetes

## 1. Kubernetes (Текущая ситуация)
**Проблема:**  
Если активный pod выходит из строя, данные нужно восстанавливать из резервной копии, что вызывает простой.

**Детали:**
- Один активный pod обращается к постоянному хранилищу.
- Если pod выходит из строя, он не может автоматически восстановиться без восстановления данных, что приводит к простоям.

---

## 2. Kubernetes (Прямое подключение NFS)
**Решение:**  
Активный и резервные pod'ы используют NFS-сервер.

**Детали:**
- Активный pod напрямую использует NFS-сервер для хранения данных.
- Резервные pod'ы реплицируют данные с помощью `rsync`.

**Компромисс:**  
Сетевые задержки влияют на производительность, так как доступ к NFS осуществляется по сети.

---

## 3. Kubernetes (RWX PVC)
**Решение:**  
Использование ReadWriteMany (RWX) PersistentVolumeClaim (PVC) для совместного использования хранилища несколькими pod'ами.

**Детали:**
- Все pod'ы (активный и резервные) используют один и тот же том.
- Репликация данных между резервными pod'ами выполняется с помощью `rsync`.

**Компромисс:**  
Требуется класс хранилища, поддерживающий RWX-тома.

---

## 4. Kubernetes (NFS как сервер синхронизации данных)
**Решение:**  
NFS-сервер выступает в качестве центрального узла синхронизации данных.

**Детали:**
- Активный pod записывает данные в постоянное хранилище.
- Резервные pod'ы синхронизируют данные с NFS-сервера.

**Компромисс:**  
Немного лучшая изоляция по сравнению с прямым подключением NFS, но добавляет сложность.

---

## 5. Kubernetes (hostPath)
**Решение:**  
Использование файловой системы worker-узла (`hostPath`).

**Детали:**
- Активный и резервные pod'ы используют `hostPath`-тома на файловой системе узла.
- Данные синхронизируются между pod'ами с помощью `rsync`.

**Компромисс:**  
Жёсткая привязка к файловой системе узла, что ограничивает портативность.

---

## 6. Виртуальная машина (без Kubernetes)
**Решение:**  
Использование автономных контейнеров Docker на виртуальной машине.

**Детали:**
- Активные и резервные контейнеры используют файловую систему ОС.
- Данные синхронизируются между контейнерами с помощью `rsync`.

**Компромисс:**  
Отсутствие оркестрации Kubernetes, менее масштабируемо, но проще.
